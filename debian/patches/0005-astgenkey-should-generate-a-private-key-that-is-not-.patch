From: "Max N. Boyarov" <max.n.boyarov@gmail.com>
Date: Sun, 14 Apr 2013 18:33:02 +0300
Subject: astgenkey should generate a private key that is not world-readable

Upstream has not accepted this patch and chose intead to document this
as a known minor issue.
---
 contrib/scripts/astgenkey |    4 ++++
 1 file changed, 4 insertions(+)

diff --git a/contrib/scripts/astgenkey b/contrib/scripts/astgenkey
index 6376048..be8853c 100644
--- a/contrib/scripts/astgenkey
+++ b/contrib/scripts/astgenkey
@@ -47,7 +47,11 @@ done
 rm -f ${KEY}.key ${KEY}.pub
 
 echo "Generating SSL key '$KEY': "
+oldumask="`umask`"
+umask 0077
 openssl genrsa -out ${KEY}.key ${DES3} 1024
+[ "$(id -u)" = 0 ] && chown asterisk: ${KEY}.key
+umask $oldumask
 openssl rsa -in ${KEY}.key -pubout -out ${KEY}.pub
 
 if [ -f "${KEY}.key" ] && [ -f "${KEY}.pub" ]; then
